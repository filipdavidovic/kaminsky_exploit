'''
    Module used to fetch SOA (domain and IP) records for the given target domain
'''

from scapy.all import DNS, DNSQR, IP, UDP, sr1
import utils
import dns
import dns.resolver
import socket

def expandLayers(x, payload):
    yield getattr(x, payload)
    while x.payload:
        x = x.payload
        yield getattr(x, payload)

def getSoaForDomain(args):
    answers = dns.resolver.query(args.targetDomain, 'SOA')
	args.soaIP = list()

	for rdata in answers:
		print ' authorative dns server: %s' % (rdata.mname)
		ans = socket.gethostbyname(str(rdata.mname))
		print ans
		args.soaIP.append(ans)